<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flappy Bat</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <!-- Mobile Fixes -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
</head>
<body>
    <div id="game-container">
        <canvas id="game-canvas"></canvas>
        <div id="game-over">
            <h2>GAME OVER</h2>
            <p>Score: <span id="final-score">0</span></p>
            <p>High Score: <span id="high-score">0</span></p>
            <button id="restart-btn">FLY AGAIN</button>
        </div>
        <div id="start-screen">
            <h1>FLAPPY BAT</h1>
            <p>Avoid the obstacles!</p>
            <button id="start-btn">START GAME</button>
        </div>
    </div>

    <!-- Audio Elements -->
    <audio id="flap-sound" src="https://cdn.pixabay.com/download/audio/2022/03/19/audio_305d5d97a5.mp3?filename=wing-flap-117482.mp3"></audio>
    <audio id="score-sound" src="https://cdn.pixabay.com/download/audio/2021/08/04/audio_bb6308eedb.mp3?filename=success-bell-6016.mp3"></audio>
    <audio id="hit-sound" src="https://cdn.pixabay.com/download/audio/2021/08/04/audio_3fd240e501.mp3?filename=negative-tone-95223.mp3"></audio>
    <audio id="bg-music" loop src="https://cdn.pixabay.com/download/audio/2023/04/06/audio_8a1b6a0d1c.mp3?filename=chill-abstract-intention-149058.mp3"></audio>

    <script src="game.js"></script>
    
    <!-- Improved Unmute Overlay -->
    <div id="unmute-overlay" style="position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); color:white; display:flex; justify-content:center; align-items:center; z-index:1000; font-family: 'Press Start 2P', cursive;">
        <div style="text-align:center; padding:20px;">
            <h2 style="color:#4cc9f0; margin-bottom:30px;">TAP ANYWHERE TO START</h2>
            <p style="color:#f72585;">(Game requires sound permission)</p>
        </div>
    </div>
    <script>
        // Unified audio/game starter
        function initGame() {
            // Hide overlay
            document.getElementById('unmute-overlay').style.display = 'none';
            
            // Unlock audio
            const bgMusic = document.getElementById('bg-music');
            bgMusic.volume = 0.3;
            bgMusic.play().catch(e => console.log("Music auto-play blocked (normal on first try)"));
            
            // Start game
            document.getElementById('start-btn').click();
        }
        
        // Single tap handler for both audio and game start
        document.getElementById('unmute-overlay').addEventListener('click', initGame);
    </script>
</body>
</html>
